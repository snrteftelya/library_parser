# NLB Catalog Scraper API

Этот проект представляет собой API для поиска книг в электронном каталоге Национальной библиотеки Беларуси. Он использует FastAPI для предоставления интерфейса и парсит сайт [e-catalog.nlb.by](https://e-catalog.nlb.by) для получения данных о книгах.

## Требования

- Python 3.8 или выше
- pip (менеджер пакетов для Python)

## Установка

Для установки всех зависимостей выполните следующие шаги:

### 1. Клонирование репозитория

Сначала клонируйте репозиторий на свою локальную машину:

```bash
git clone https://github.com/snrteftelya/library_parser.git
cd library_parser
```

### 2. Создание виртуальной среды

Для изоляции зависимостей рекомендуется использовать виртуальную среду. Вы можете создать её с помощью `venv`:

```bash
python -m venv .venv
```

Активируйте виртуальную среду:

- Для Windows:
  ```bash
  .\.venv\Scripts\activate
  ```

- Для Linux/MacOS:
  ```bash
  source .venv/bin/activate
  ```

### 3. Установка зависимостей

После активации виртуальной среды установите все необходимые зависимости с помощью `pip`:

```bash
pip install -r requirements.txt
```

### 4. Запуск приложения

Для запуска FastAPI сервера используйте команду:

```bash
uvicorn app:app --reload
```

Сервер будет доступен по адресу [http://127.0.0.1:8000](http://127.0.0.1:8000).

- **`--reload`** позволяет автоматически перезагружать сервер при изменении кода, что полезно в процессе разработки.

### 5. Доступ к документации API

После запуска сервера вы можете открыть документацию API в браузере, перейдя по следующему URL:

```
http://127.0.0.1:8000/docs
```

Документация будет сгенерирована автоматически с помощью Swagger UI.

## Использование API

### Эндпоинт: `/books`

Метод: `GET`

Описание: Поиск книг по запросу.

#### Параметры запроса:

- **query** (строка, обязательный параметр): Поисковый запрос (например, название книги или автора).
- **type** (строка, необязательный параметр): Тип поиска. Возможные значения:
  - `"AllFields"` (поиск по всем полям),
  - `"Title"` (поиск по заглавию),
  - `"Author"` (поиск по автору),
  - `"Subject"` (поиск по предмету),
  - `"ISBN"` (поиск по ISBN).
- **limit** (целое число, необязательный параметр): Ограничение на количество результатов (по умолчанию 5, диапазон от 1 до 50).

#### Пример запроса:

```bash
GET http://127.0.0.1:8000/books?query=flat&type=Title&limit=5
```

#### Пример ответа:

```json
[
  {
    "title": "Книга 1",
    "picture": "https://e-catalog.nlb.by/cover1.jpg",
    "rows": [
      {
        "Автор": "Автор 1"
      },
      {
        "Издательство": "Издательство 1"
      }
    ]
  },
  {
    "title": "Книга 2",
    "picture": "https://e-catalog.nlb.by/cover2.jpg",
    "rows": [
      {
        "Автор": "Автор 2"
      },
      {
        "Издательство": "Издательство 2"
      }
    ]
  }
]
```

### Ошибки

- **400 Bad Request**: Некорректный тип поиска.
- **404 Not Found**: Не удалось найти книги по данному запросу.

## Тестирование

Для тестирования API можно использовать любые HTTP-клиенты, такие как `curl`, Postman или браузер (для доступа к документации через Swagger).

Пример запроса через `curl`:

```bash
curl -X 'GET' \
  'http://127.0.0.1:8000/books?query=flat&type=Title&limit=5' \
  -H 'accept: application/json'
```

## Завершение работы

Когда вы закончите работу, не забудьте деактивировать виртуальную среду:

```bash
deactivate
```